<html>
  <head>
    <meta content='text/html;charset=UTF-8' http-equiv='Content-Type'>
    <title>OptiML &mdash; Examples</title>
    <style type='text/css'>
      @import '../css/default.css';
      @import '../css/syntax.css';
      @import '../css/textmate.css';
    </style>
    <style media='print' type='text/css'>
      @import '../css/print.css';
    </style>
    <meta content='Delite documentation' name='subject'>
    <!-- <link href='images/favicon.png' rel='shortcut icon'> -->
  </head>
  <body>
    <div id='outer'>
      <div id='header'>
        <div class='home'><a href='http://stanford-ppl.github.com/Delite/optiml/' title="OptiML">OptiML</a></div>
      </div>
      <div id='menu'>
        <ol>
          <li>Start Here
            <ol>
              <li><a href='index.html'>Welcome</a></li>
              <li><a href='getting_started.html'>Getting Started</a></li>
              <li><a href="examples.html">Examples</a></li>
              <li><a href="faq.html">FAQ</a></li>
              <li><a href="debugging.html">Debugging</a></li>
              <li><a href="getting_started_native.html">Native Libraries and CUDA</a></li>
              <li><a href="http://groups.google.com/group/optiml">Mailing List</a></li>
              <li><a href="downloads/optiml-spec.pdf">Language Specification</a></li>
              <li><a href='http://stanford-ppl.github.com/Delite/index.html'>Delite</a></li>
            </ol>
          </li> 
          <!--
          <li>Reference
            <ol>
              <li><a href='api/0.3/index.html'>ScalaDoc API</a></li>
              <li>&nbsp;</li>
              <li><a href='sponsors.html'>Sponsors</a></li>
              <li class="logo"><a href="http://ppl.stanford.edu"><img width="110" alt="Stanford Pervasive Parallelism Lab" src='images/ppl_logo_small.png'></a></li>
            </ol>
          </li>
          -->
        </ol>
      </div>
      <div id='content'> 
        <h1 id='title_examples'>Examples</h1>
        <p> This page is intended to help users get familiar with OptiML through a series of simple examples. All of
            the source code for the examples is available and runnable from the OptiML github repository.
            Comprehensive documentation of OptiML syntax and features can be found in
            the <a href="downloads/optiml-spec.pdf">language specification</a>. There are also several
            more thorough example applications located in the <code>apps</code> directory in the repository.</p>
        <h3> Operations </h3> 
        <ol>
          <li><a href="#basics">Basics</a></li>
          <li><a href="#construction">Constructing new vectors and matrices</a></li>
          <li><a href="#functional">Using functional operators</a></li>
          <li><a href="#iteration">Iterating with for and while</a></li>
          <li><a href="#io">I/O</a></li>
          <li><a href="#untilconverged">Iterative computation with untilconverged</a></li>
          <li><a href="#sum">Summations</a></li>
          <!--
          <li><a href="#sparse">Sparse vectors and matrices</a></li>
          <li><a href="#graph">Message passing graphs</a></li>
          -->
        </ol>
        <h3> Other topics </h3>
        <ol>
          <li><a href="#mutability">Working with mutable objects</a></li>
          <li><a href="#types">Using explicit types</a></li>
          <li><a href="#organization">Organizing code with methods and traits</a></li>
          <li><a href="#userstruct">User-defined data structures</a></li>
        </ol>
        <div id='basics'>
        <h2> Basics </h2>
        <p> This example shows simple manipulations of vectors and matrices, which are the core data structure in OptiML. </p>
        <p>
        <!-- auto generated by TextMate -->
<pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example1Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example1</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example1</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>  
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 10000x1 DenseVector
</span><span class='linenum'>    5</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v1</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10000</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    6</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1000x1000 DenseMatrix
</span><span class='linenum'>    7</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span>,<span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    8</span>     
<span class='linenum'>    9</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> perform some simple infix operations
</span><span class='linenum'>   10</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span>v1<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span><span class="constant constant_numeric constant_numeric_scala">2</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">-</span><span class="constant constant_numeric constant_numeric_scala">5</span>
<span class='linenum'>   11</span>     
<span class='linenum'>   12</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> take the pointwise natural log of v2 and sum results
</span><span class='linenum'>   13</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">logv2Sum</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> log<span class="meta meta_bracket meta_bracket_scala">(</span>v2<span class="meta meta_bracket meta_bracket_scala">)</span>.sum
<span class='linenum'>   14</span>     
<span class='linenum'>   15</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> slice elems 1000-2000 of v2 and multiply by m
</span><span class='linenum'>   16</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v3</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v2<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">2000</span><span class="meta meta_bracket meta_bracket_scala">)</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>m <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1x1000 DenseVector result
</span><span class='linenum'>   17</span>      
<span class='linenum'>   18</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> print the first 10 elements to the screen
</span><span class='linenum'>   19</span>     v3<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span>.pprint   
<span class='linenum'>   20</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   21</span> <span class="meta meta_bracket meta_bracket_scala">}</span></span></pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- basics -->
      <div id='construction'>
        <h2> Constructing new vectors and matrices </h2>
        <p> This example shows various ways of constructing vectors and matrices in OptiML. </p>
        <p>
        <!-- auto generated by TextMate -->
        <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example2Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example2</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example2</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_block comment_block_scala">/* various ways of constructing a DenseVector */</span>
<span class='linenum'>    5</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v0</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [ 100 ]
</span><span class='linenum'>    6</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v1</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="constant constant_numeric constant_numeric_scala">100</span>,<span class="constant constant_language constant_language_scala">false</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1x100 all zeros, ints
</span><span class='linenum'>    7</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v3</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x1 random doubles
</span><span class='linenum'>    8</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v4</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.zeros<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x1 all zeros, doubles    
</span><span class='linenum'>    9</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v5</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1</span>,<span class="constant constant_numeric constant_numeric_scala">2</span>,<span class="constant constant_numeric constant_numeric_scala">3</span>,<span class="constant constant_numeric constant_numeric_scala">4</span>,<span class="constant constant_numeric constant_numeric_scala">5</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [1,2,3,4,5]
</span><span class='linenum'>   10</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v6</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1</span>.,<span class="constant constant_numeric constant_numeric_scala">2</span>.,<span class="constant constant_numeric constant_numeric_scala">3</span>.,<span class="constant constant_numeric constant_numeric_scala">4</span>.,<span class="constant constant_numeric constant_numeric_scala">5</span>.<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [1.0,2.0,3.0,4.0,5.0]
</span><span class='linenum'>   11</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v7</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> random<span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">]</span> <span class="meta meta_bracket meta_bracket_scala">}</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x1, random ints
</span><span class='linenum'>   12</span>     
<span class='linenum'>   13</span>     <span class="comment comment_block comment_block_scala">/* various ways of constructing a DenseMatrix */</span>
<span class='linenum'>   14</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m0</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="constant constant_numeric constant_numeric_scala">100</span>,<span class="constant constant_numeric constant_numeric_scala">50</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x50 zeros, ints
</span><span class='linenum'>   15</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m1</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">100</span>,<span class="constant constant_numeric constant_numeric_scala">50</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x50 random doubles
</span><span class='linenum'>   16</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span>.zeros<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">100</span>,<span class="constant constant_numeric constant_numeric_scala">50</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100x50 zeros, doubles
</span><span class='linenum'>   17</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m3</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1</span>,<span class="constant constant_numeric constant_numeric_scala">2</span>,<span class="constant constant_numeric constant_numeric_scala">3</span><span class="meta meta_bracket meta_bracket_scala">)</span>,<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">4</span>,<span class="constant constant_numeric constant_numeric_scala">5</span>,<span class="constant constant_numeric constant_numeric_scala">6</span><span class="meta meta_bracket meta_bracket_scala">))</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [1,2,3]
</span><span class='linenum'>   18</span>                                           <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [4,5,6]
</span><span class='linenum'>   19</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m4</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">2</span>, <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">2</span>,<span class="constant constant_numeric constant_numeric_scala">3</span>,<span class="constant constant_numeric constant_numeric_scala">4</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">}</span>  <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [2,3,4]
</span><span class='linenum'>   20</span>                                                     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [2,3,4]
</span><span class='linenum'>   21</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m5</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">2</span>, <span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">2</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> <span class="meta meta_bracket meta_bracket_scala">(</span>i,j<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> i<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>j <span class="meta meta_bracket meta_bracket_scala">}</span>  <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [0,0]
</span><span class='linenum'>   22</span>                                             <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> [0,1]                               
</span><span class='linenum'>   23</span>                    
<span class='linenum'>   24</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> print first row                          
</span><span class='linenum'>   25</span>     m5<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span>.pprint
<span class='linenum'>   26</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   27</span> <span class="meta meta_bracket meta_bracket_scala">}</span></span></pre>
        <!-- end auto generated by TextMate -->
      </p></div> <!-- vec/mat construction -->
      <div id='functional'>
        <h2>Using functional operators</h2>
        <p> Functional operators are a key piece of making OptiML more concise and expressive. This example demonstrates
            some of the more common operations and how they are typically chained together. These operators are usually
            parallel, so will speed up when run with more threads, and fused together, so they use less memory than
            typical bulk collection operators.</p> 
        <p>
        <!-- auto generated by TextMate -->
        <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example3Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example3</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example3</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    5</span> 
<span class='linenum'>    6</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> filter selects all the elements matching a predicate
</span><span class='linenum'>    7</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> map constructs a new vector by applying a function to each element    
</span><span class='linenum'>    8</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span>v<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span>.filter<span class="meta meta_bracket meta_bracket_scala">(</span>e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span> <span class="constant constant_numeric constant_numeric_scala">500</span><span class="meta meta_bracket meta_bracket_scala">)</span>.map<span class="meta meta_bracket meta_bracket_scala">(</span>e<span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span>e<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>e<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>random<span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">])</span>
<span class='linenum'>    9</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span>v2.length<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   10</span>     
<span class='linenum'>   11</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> reduce produces a scalar by successively applying a function to pairs
</span><span class='linenum'>   12</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">logmin</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v2.reduce<span class="meta meta_bracket meta_bracket_scala">((</span>a,b<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">if</span> <span class="meta meta_bracket meta_bracket_scala">(</span>log<span class="meta meta_bracket meta_bracket_scala">(</span>a<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span> log<span class="meta meta_bracket meta_bracket_scala">(</span>b<span class="meta meta_bracket meta_bracket_scala">))</span> a <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">else</span> b<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   13</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span>logmin<span class="meta meta_bracket meta_bracket_scala">)</span>        
<span class='linenum'>   14</span>     
<span class='linenum'>   15</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> partition splits the vector into two based on a predicate
</span><span class='linenum'>   16</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="meta meta_bracket meta_bracket_scala">(</span>v2small, v2large<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> unpack(v2.partition<span class="meta meta_bracket meta_bracket_scala">(</span>e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span> <span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">))</span>
<span class='linenum'>   17</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"v2small size: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> v2small.length<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   18</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"v2large size: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> v2large.length<span class="meta meta_bracket meta_bracket_scala">)</span>    
<span class='linenum'>   19</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   20</span> <span class="meta meta_bracket meta_bracket_scala">}</span></span></pre>
        <!-- end auto generated by TextMate -->
      </p></div> <!-- functional operators -->
      <div id='iteration'>
        <h2>Iterating with 'for' and 'while'</h2>
        <p> Although functional operators are the preferred way of operating on vectors and matrices in OptiML, the language
        also supports both parallel and sequential iteration using 'for' and 'while' respectively. However, using either of
        these constructs requires some care. The body of 'for' loops must not contain conflicting (non-disjoint) writes, or
        the result will be incorrect (due to races); in the future, we plan to automatically detect these cases and report them
        as stage-time errors. 'while' loops should be used only as a last resort; their sequential nature prevents OptiML from
        parallelizing the loop and also inhibits optimizations like fusion.
        </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example4Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example4</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example4</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> a DenseVector[DenseVector[Double]]
</span><span class='linenum'>    5</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 100 vectors, each containing 1000 random doubles
</span><span class='linenum'>    6</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.zeros<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span>.map<span class="meta meta_bracket meta_bracket_scala">(</span>e <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">))</span>
<span class='linenum'>    7</span>     
<span class='linenum'>    8</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> iterate using for (parallel)    
</span><span class='linenum'>    9</span>     <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">for</span> <span class="meta meta_bracket meta_bracket_scala">(</span>vec <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">-</span> v<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   10</span>       <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> prints can happen in any order!
</span><span class='linenum'>   11</span>       <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">if</span> <span class="meta meta_bracket meta_bracket_scala">(</span>vec<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&gt;</span> .<span class="constant constant_numeric constant_numeric_scala">9</span><span class="meta meta_bracket meta_bracket_scala">)</span> println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"found &gt; .9"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   12</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   13</span>     
<span class='linenum'>   14</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> iterate using while (sequential)
</span><span class='linenum'>   15</span>     <span class="keyword keyword_declaration keyword_declaration_volatile keyword_declaration_volatile_scala">var</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">i</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">0</span>
<span class='linenum'>   16</span>     <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">while</span> <span class="meta meta_bracket meta_bracket_scala">(</span>i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span> v.length<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   17</span>       <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vi</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   18</span>       <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> prints always in order
</span><span class='linenum'>   19</span>       println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"first element of vector "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> i <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> <span class="string string_quoted string_quoted_double string_quoted_double_scala">": "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> vi<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">))</span>
<span class='linenum'>   20</span>       i <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">1</span>
<span class='linenum'>   21</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   22</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   23</span> <span class="meta meta_bracket meta_bracket_scala">}</span></span></pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!--iteration -->
      <div id='io'>
        <h2>I/O</h2>
        <p> OptiML supports MATLAB-like read functions to load vectors and matrices from a file. As this example shows,
        you can also supply a function to tell OptiML how to parse a line in the input file in order to populate the
        vector or matrix. To run the example, make sure the input files described in the comments exist in the current
        working directory (the directory from which you run the <code>delite</code> command to start the program). </p>
        <p> 
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> myvector.dat
</span><span class='linenum'>    2</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 0.1 
</span><span class='linenum'>    3</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 0.5 
</span><span class='linenum'>    4</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1.2 
</span><span class='linenum'>    5</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1.3 
</span><span class='linenum'>    6</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 0.6 
</span><span class='linenum'>    7</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span>
</span><span class='linenum'>    8</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> myvector2.dat
</span><span class='linenum'>    9</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 1;blue;-1
</span><span class='linenum'>   10</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 16;green;3
</span><span class='linenum'>   11</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 3;red;55
</span><span class='linenum'>   12</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span>
</span><span class='linenum'>   13</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> mymatrix.dat
</span><span class='linenum'>   14</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 3 12 5
</span><span class='linenum'>   15</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> 17 32 1
</span><span class='linenum'>   16</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> -6 1 0
</span><span class='linenum'>   17</span> <span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example5Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example5</span>
<span class='linenum'>   18</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example5</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>   19</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   20</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> simple i/o
</span><span class='linenum'>   21</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> readVector<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"myvector.dat"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   22</span>     v.pprint
<span class='linenum'>   23</span>     
<span class='linenum'>   24</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> readMatrix<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"mymatrix.dat"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   25</span>     m.pprint
<span class='linenum'>   26</span>     
<span class='linenum'>   27</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> i/o with custom parser
</span><span class='linenum'>   28</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> second argument is a function from a DenseVector[String] to a Double
</span><span class='linenum'>   29</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> third argument is the delimeter used to split the line
</span><span class='linenum'>   30</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> readVector<span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"myvector2.dat"</span>, line <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> line<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span>.toDouble, <span class="string string_quoted string_quoted_double string_quoted_double_scala">";"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   31</span>     v2.pprint    
<span class='linenum'>   32</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   33</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   34</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!--i/o -->
      <div id='untilconverged'>
        <h2>Iterative computation with untilconverged</h2>
        <p> Many common machine learning problems have an iterative structure. OptiML makes these problems easier to express
        using a built-in <code>untilconverged</code> control structure, which iterates until either the delta between solutions
        falls below a supplied threshold or a maximum number of iterations has been reached. The following example shows one
        simple way of using untilconverged on a scalar value (but it can also be used with vectors, matrices, and graphs). </p>        
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example6Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example6</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example6</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> newton descent
</span><span class='linenum'>    5</span>     
<span class='linenum'>    6</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> arbitrary initial values
</span><span class='linenum'>    7</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">c0</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">0.0</span>
<span class='linenum'>    8</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">c1</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">1.2</span>
<span class='linenum'>    9</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">c2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">9.7</span>    
<span class='linenum'>   10</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">linit</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">5.5</span> 
<span class='linenum'>   11</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">lambda</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   12</span>       untilconverged<span class="meta meta_bracket meta_bracket_scala">(</span>linit, .<span class="constant constant_numeric constant_numeric_scala">001</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> lambda <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span>
<span class='linenum'>   13</span>         <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">l2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> lambda<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>lambda
<span class='linenum'>   14</span>         <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">b</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span>l2 <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> c2<span class="meta meta_bracket meta_bracket_scala">)</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>lambda
<span class='linenum'>   15</span>         <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">a</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> b <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> c1
<span class='linenum'>   16</span>         lambda <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">-</span> <span class="meta meta_bracket meta_bracket_scala">(</span>a <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span> lambda <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> c0<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">/</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">2.0</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>lambda<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>l2 <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> b <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> a<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   17</span>       <span class="meta meta_bracket meta_bracket_scala">}</span>    
<span class='linenum'>   18</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"lambda: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> lambda<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   19</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   20</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   21</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- untilconverged -->
      <div id='sum'>
        <h2>Summations</h2>
        <p> Since summations are so ubitiquous in machine learning, OptiML allows users to sum pure computations over a particular range.
        This example shows all four variants: <code>sum</code>, <code>sumRows</code>, <code>sumIf</code>, and <code>sumRowsIf</code>. The latter
        two allow you to specify a predicate; the computed value is only added to the sum if the predicate is true. <code>sumRows</code> is a
        specialized version of <code>sum</code> where the result of the function is a matrix row - it allows adding the values from the underlying
        matrix directly into the accumulator without creating a copy of each row. (In other words, it sums multiple <code>DenseVectorView</code>s into an
        output <code>DenseVector</code>). </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example7Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example7</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example7</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">simpleSeries</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> sum<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>, <span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> i <span class="meta meta_bracket meta_bracket_scala">}</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> sum(0,1,2,3,...99)
</span><span class='linenum'>    5</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"simpleSeries: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> simpleSeries<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    6</span>     
<span class='linenum'>    7</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">m</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseMatrix</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10</span>,<span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span>    
<span class='linenum'>    8</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> sum first 10 rows of m
</span><span class='linenum'>    9</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">rowSum</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> sumRows<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>,<span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> m<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   10</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"rowSum:"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   11</span>     rowSum.pprint
<span class='linenum'>   12</span> 
<span class='linenum'>   13</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> sum(0,2,4,8...98)
</span><span class='linenum'>   14</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">conditionalSeries</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> sumIf<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>,<span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)(</span>i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> i <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">%</span> <span class="constant constant_numeric constant_numeric_scala">2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">==</span> <span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> i <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   15</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"conditionalSeries: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> conditionalSeries<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   16</span>     
<span class='linenum'>   17</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> conditional sum over rows of a matrix
</span><span class='linenum'>   18</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">conditionalRowSum</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> sumRowsIf<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>,<span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)(</span>i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> m<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="meta meta_bracket meta_bracket_scala">)</span>.min <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&gt;</span> .<span class="constant constant_numeric constant_numeric_scala">01</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> m<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   19</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"conditionalRowSum:"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   20</span>     conditionalRowSum.pprint
<span class='linenum'>   21</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   22</span> <span class="meta meta_bracket meta_bracket_scala">}</span></span></pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- sum -->
      <div id='mutability'>
        <h2>Working with mutable objects</h2>
        <p> OptiML was designed to be easy to parallelize and optimize and thus has a natural tendency towards immutable,
        functional operators. However, we didn't want to forbid mutation in all cases, as there are times when it is either
        more convenient, easier to read, or can perform better due to an application-level optimization than the immutable
        version. However, in order to retain as much optimization potential as we can, we do forbid mutations on objects
        <b>unless</b> they are explicitly marked <code>mutable</code>. This example demonstrates these restrictions and shows
        how to mutate a vector. </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example10Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example10</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example10</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vMut</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="constant constant_numeric constant_numeric_scala">1000</span>, <span class="constant constant_language constant_language_scala">true</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> mutable vector initialized to all zeros
</span><span class='linenum'>    5</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vImm</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> immutable vector initialized to random values
</span><span class='linenum'>    6</span>     
<span class='linenum'>    7</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vImm2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> vMut<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="constant constant_numeric constant_numeric_scala">5</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> mutability is not inherited! the new vector is immutable
</span><span class='linenum'>    8</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vMut2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> vImm2.mutable <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> but we can always ask for a mutable copy if we need one
</span><span class='linenum'>    9</span>   
<span class='linenum'>   10</span>     <span class="keyword keyword_declaration keyword_declaration_volatile keyword_declaration_volatile_scala">var</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">i</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">0</span>
<span class='linenum'>   11</span>     <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">while</span> <span class="meta meta_bracket meta_bracket_scala">(</span>i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&lt;</span> vMut.length<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   12</span>       <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">if</span> <span class="meta meta_bracket meta_bracket_scala">(</span>i <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">%</span> <span class="constant constant_numeric constant_numeric_scala">10</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">==</span> <span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   13</span>         vMut<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">1</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> ok
</span><span class='linenum'>   14</span>         <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> vImm(i) = 1 // would cause a stage-time error!        
</span><span class='linenum'>   15</span>       <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   16</span>       i <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">1</span>
<span class='linenum'>   17</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   18</span>     
<span class='linenum'>   19</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"vMut(10): "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> vMut<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">))</span>    
<span class='linenum'>   20</span>     
<span class='linenum'>   21</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> nested mutable objects are not allowed!
</span><span class='linenum'>   22</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">vNestedMut</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]](</span><span class="constant constant_numeric constant_numeric_scala">10</span>, <span class="constant constant_language constant_language_scala">true</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   23</span>     vNestedMut<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> vImm2 <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> ok
</span><span class='linenum'>   24</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> vNestedMut(0) = vMut // would cause a stage-time error!    
</span><span class='linenum'>   25</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   26</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   27</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- mutability -->
      <div id='types'>
        <h2>Using explicit types</h2>
        <p> OptiML is statically-typed by virtue of being embedded in Scala. Usually, type annotations are not required in
        OptiML due to type inference. The most important thing to know about using explicit types is that OptiML has two
        classes of types: those wrapped inside the type constructor <code>Rep[T]</code> represent <i>stage-time</i> types;
        code will be generated for operations on stage-time types to be executed later on multiple platforms; types that are
        not wrapped in <code>Rep[T]</code> are ordinary Scala types and will execute <b>while the program is being staged</b>.
        This is a form of partial evaluation that can be used to do simple computations ahead-of-time (i.e. during compilation).
        The following example shows how this type distinction appears in real OptiML code. </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example11Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example11</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example11</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> an explicitly-typed result
</span><span class='linenum'>    5</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> Rep[T] is a type constructor representing staged values
</span><span class='linenum'>    6</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]]</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    7</span>     
<span class='linenum'>    8</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> values that are not wrapped in Rep[] are evaluated at compile time, e.g.
</span><span class='linenum'>    9</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">scalar</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="constant constant_numeric constant_numeric_scala">5</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span><span class="constant constant_numeric constant_numeric_scala">12</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">/</span><span class="constant constant_numeric constant_numeric_scala">3.3</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="constant constant_numeric constant_numeric_scala">1</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> this is executed immediately when we are staging
</span><span class='linenum'>   10</span>                                     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> no code will be generated for these statements
</span><span class='linenum'>   11</span> 
<span class='linenum'>   12</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> you can still use unstaged values in staged computations
</span><span class='linenum'>   13</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v2</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]]</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>scalar 
<span class='linenum'>   14</span>     
<span class='linenum'>   15</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> all values returned by the DSL are staged
</span><span class='linenum'>   16</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">scalar2</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v2.sum
<span class='linenum'>   17</span>     
<span class='linenum'>   18</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span>scalar2<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   19</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   20</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   21</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- types -->
      <div id='organization'>
        <h2>Organizing code with methods and traits</h2>
        <p> All OptiML code must be executed within the dynamic scope of the <code>main</code> method in order
        to be staged. However, you can still organize your code into separate methods and traits, as shown in
        this example (and different traits can be put in different source files). A 'trait' is a type of Scala
        class that supports mix-in inheritance using the <code>with</code> keyword. Note that global variables
        outside of the <code>main</code> method is not allowed, since this isn't within the dynamic scope. Therefore,
        methods either require all of their parameters to be passed in explicitly, or must be declared as sub-methods
        within <code>main</code>. </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example12Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example12</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example12</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example12work</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> code can be organized into different methods and traits
</span><span class='linenum'>    5</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> these methods get inlined during staging    
</span><span class='linenum'>    6</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">DenseVector</span>.rand<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">1000</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    7</span>     doWork<span class="meta meta_bracket meta_bracket_scala">(</span>v<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> defined in Example6work
</span><span class='linenum'>    8</span>     doWork2<span class="meta meta_bracket meta_bracket_scala">(</span>v<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>    9</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">a</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> doWork3<span class="meta meta_bracket meta_bracket_scala">(</span>v<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   10</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span>a<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   11</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   12</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   13</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example12work</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   14</span>   <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> methods signatures require types; return types are optional
</span><span class='linenum'>   15</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">doWork</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">v</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]])</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   16</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"v length is: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> v.length<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   17</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   18</span>   
<span class='linenum'>   19</span>   <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> methods can use generic types, too
</span><span class='linenum'>   20</span>   <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> but you have to include this ":Manifest" boilerplate
</span><span class='linenum'>   21</span>   <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> Manifest is a Scala object that stores type information for T
</span><span class='linenum'>   22</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">doWork2</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">T</span><span class="keyword keyword_operator keyword_operator_scala">:</span><span class="entity entity_name entity_name_class">Manifest</span><span class="meta meta_bracket meta_bracket_scala">](</span><span class="variable variable_parameter">v</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">T</span><span class="meta meta_bracket meta_bracket_scala">]])</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   23</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"v(0) is: "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> v<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="meta meta_bracket meta_bracket_scala">))</span>
<span class='linenum'>   24</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   25</span>   
<span class='linenum'>   26</span>   <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> an example method returning a value with an explicit return type
</span><span class='linenum'>   27</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">doWork3</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">v</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">DenseVector</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]])</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Double</span><span class="meta meta_bracket meta_bracket_scala">]</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   28</span>     <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">if</span> <span class="meta meta_bracket meta_bracket_scala">(</span>v.length <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">&gt;</span> <span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   29</span>       v<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   30</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   31</span>     <span class="keyword keyword_control keyword_control_flow keyword_control_flow_scala">else</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   32</span>       <span class="constant constant_numeric constant_numeric_scala">0.0</span>
<span class='linenum'>   33</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   34</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   35</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   36</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- organization --> 
      <div id='userstruct'>
        <h2>Used-defined data structures</h2>
        <p>Users can define their own struct-like data structures (data only, no methods), using the <code>new Record</code> keyword.
        These structs can contain fields that are OptiML types (or other user-defined structs). However, they cannot be recursive (a struct
        field cannot refer to the defining struct). These restrictions help enable high performance and the ability to run on multiple
        devices. The following example shows to define a simple custom struct in OptiML and then use that struct within vectors. </p>
      <p>
      <!-- auto generated by TextMate -->
      <pre class="textmate-source"><span class='linenum'>    1</span> <span class="source source_scala"><span class="keyword keyword_declaration keyword_declaration_scala">object</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example13Interpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplicationInterpreter</span> <span class="keyword keyword_declaration keyword_declaration_scala">with</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">Example13</span>
<span class='linenum'>    2</span> <span class="keyword keyword_declaration keyword_declaration_scala">trait</span> <span class="entity entity_name entity_name_class entity_name_class_declaration">Example13</span> <span class="keyword keyword_declaration keyword_declaration_scala">extends</span> <span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_scala">OptiMLApplication</span> <span class="meta meta_bracket meta_bracket_scala">{</span> 
<span class='linenum'>    3</span>   <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">main</span><span class="meta meta_parentheses meta_parentheses_scala"><span class="meta meta_bracket meta_bracket_scala">()</span></span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>    4</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> type alias is for convenience
</span><span class='linenum'>    5</span>     <span class="keyword keyword_declaration keyword_declaration_scala">type</span> <span class="entity entity_name entity_name_type entity_name_type_declaration">MyStruct</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="entity entity_name entity_name_class">Record</span><span class="meta meta_bracket meta_bracket_scala">{</span><span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">data</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span>; <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">name</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="storage storage_type storage_type_scala">String</span><span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>    6</span>     
<span class='linenum'>    7</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> method to construct a new instance of MyStruct, also for convenience    
</span><span class='linenum'>    8</span>     <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">newMyStruct</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">_data</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">_name</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_scala">String</span><span class="meta meta_bracket meta_bracket_scala">])</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>    9</span>       <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> a user-defined struct instance is declared as a new Record
</span><span class='linenum'>   10</span>       <span class="keyword keyword_declaration keyword_declaration_scala">new</span> <span class="entity entity_name entity_name_class">Record</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   11</span>         <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">data</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> _data
<span class='linenum'>   12</span>         <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">name</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> _name
<span class='linenum'>   13</span>       <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   14</span>     
<span class='linenum'>   15</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> we can use our struct with normal OptiML data types
</span><span class='linenum'>   16</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v1</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>i, <span class="string string_quoted string_quoted_double string_quoted_double_scala">"struct "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> i<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   17</span>     
<span class='linenum'>   18</span>     <span class="comment comment_line comment_line_double-slash comment_line_double-slash_scala"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_scala">//</span> we can even use math operators by defining how arithmetic works with MyStruct
</span><span class='linenum'>   19</span>     <span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">myStructArith</span><span class="keyword keyword_operator keyword_operator_scala">:</span> <span class="entity entity_name entity_name_class">Arith</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="keyword keyword_declaration keyword_declaration_scala">new</span> <span class="entity entity_name entity_name_class">Arith</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span> <span class="meta meta_bracket meta_bracket_scala">{</span>
<span class='linenum'>   20</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">+=</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">b</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   21</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.data,a.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   22</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">+</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">b</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   23</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.data,a.name<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">" pl "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   24</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">-</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">b</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   25</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">-</span>b.data,a.name<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">" mi "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   26</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">*</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">b</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   27</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>b.data,a.name<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">" ti "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   28</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">/</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">]</span>, <span class="variable variable_parameter">b</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   29</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">/</span>b.data,a.name<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">" di "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>b.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   30</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">abs</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   31</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>arith_abs<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="meta meta_bracket meta_bracket_scala">)</span>,<span class="string string_quoted string_quoted_double string_quoted_double_scala">"abs "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>a.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   32</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">exp</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   33</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>arith_exp<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="meta meta_bracket meta_bracket_scala">)</span>.<span class="entity entity_name entity_name_class">AsInstanceOf</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">]</span>,<span class="string string_quoted string_quoted_double string_quoted_double_scala">"exp "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>a.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   34</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">log</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   35</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>arith_log<span class="meta meta_bracket meta_bracket_scala">(</span>a.data<span class="meta meta_bracket meta_bracket_scala">)</span>.<span class="entity entity_name entity_name_class">AsInstanceOf</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="storage storage_type storage_type_primitive storage_type_primitive_scala">Int</span><span class="meta meta_bracket meta_bracket_scala">]</span>,<span class="string string_quoted string_quoted_double string_quoted_double_scala">"log "</span><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>a.name<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   36</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">empty</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   37</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>,<span class="string string_quoted string_quoted_double string_quoted_double_scala">"empty"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   38</span>       <span class="keyword keyword_declaration keyword_declaration_scala">def</span> <span class="entity entity_name entity_name_function entity_name_function_declaration">zero</span><span class="meta meta_bracket meta_bracket_scala">(</span><span class="variable variable_parameter">a</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">Rep</span><span class="meta meta_bracket meta_bracket_scala">[</span><span class="entity entity_name entity_name_class">MyStruct</span><span class="meta meta_bracket meta_bracket_scala">])(</span><span class="storage storage_modifier storage_modifier_other">implicit</span> <span class="variable variable_parameter">ctx</span><span class="meta meta_colon meta_colon_scala">:</span> <span class="entity entity_name entity_name_class">SourceContext</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> 
<span class='linenum'>   39</span>         newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span>,<span class="string string_quoted string_quoted_double string_quoted_double_scala">"zero"</span><span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   40</span>     <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   41</span>     
<span class='linenum'>   42</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">v2</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> <span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">0</span><span class="keyword keyword_operator keyword_operator_scala">::</span><span class="constant constant_numeric constant_numeric_scala">100</span><span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">{</span> i <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=&gt;</span> newMyStruct<span class="meta meta_bracket meta_bracket_scala">(</span>i<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">*</span>i, <span class="string string_quoted string_quoted_double string_quoted_double_scala">"struct2 "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> i<span class="meta meta_bracket meta_bracket_scala">)</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   43</span>     
<span class='linenum'>   44</span>     <span class="keyword keyword_declaration keyword_declaration_stable keyword_declaration_stable_scala">val</span> <span class="entity entity_name entity_name_val entity_name_val_declaration">result</span> <span class="keyword keyword_operator keyword_operator_comprasion keyword_operator_comprasion_scala">=</span> v1<span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span>v2
<span class='linenum'>   45</span>     println<span class="meta meta_bracket meta_bracket_scala">(</span><span class="string string_quoted string_quoted_double string_quoted_double_scala">"result(10) with name "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> result<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span>.name <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> <span class="string string_quoted string_quoted_double string_quoted_double_scala">" has data "</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_scala">+</span> result<span class="meta meta_bracket meta_bracket_scala">(</span><span class="constant constant_numeric constant_numeric_scala">10</span><span class="meta meta_bracket meta_bracket_scala">)</span>.data<span class="meta meta_bracket meta_bracket_scala">)</span>
<span class='linenum'>   46</span>   <span class="meta meta_bracket meta_bracket_scala">}</span>
<span class='linenum'>   47</span> <span class="meta meta_bracket meta_bracket_scala">}</span>
</span><span class='linenum'>   48</span> </pre>
      <!-- end auto generated by TextMate -->
      </p></div> <!-- user-defined types --> 
      </div>
      <div id='footer'>Copyright &copy; 2011</div>
    </div>
  </body>
</html>
